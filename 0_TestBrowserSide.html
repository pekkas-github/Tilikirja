<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  </head>
  <body>
    Integration Test Tilikirja
  <?!= TestFrame.getTestFrameScript() ?>
  <?!= BrowserLibraries.importLib('DBMS') ?>
  <?!= BrowserLibraries.importLib('ServerAccess') ?>
  <?!= app.include('EventsModel') ?>
  <?!= app.include('EventsController') ?>
  <?!= app.include('EventsView') ?>
  <?!= app.include('EventFormView') ?>
  <?!= app.include('EventCommentView') ?>
  <?!= app.include('ReadingsModel') ?>
  <?!= app.include('ReadingsController') ?>
  <?!= app.include('ReadingsView') ?>
  <?!= app.include('CommonModel') ?>
  <?!= app.include('globals') ?>


  <script>

    function startTest() {
      Db.init().then(() => {
        const reading = {id:0, date:'2023-08-07', master_reading:500, a_reading:4820, b_reading:5280, comment:'Testing', fiscal_year:2023}
        ReadingsModel.addReading(reading).then(() => {
          console.table(Db.water)
        })
      })
    }

  // Refresh remote tables
  google.script.run
  .withSuccessHandler(startTest)
  .resumeTable(['events', 'water'])
    
  </script>

  </body>
</html>
