<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    Integration Test Tilikirja
  <?!= TestFrame.getTestFrameScript() ?>
  <?!= BrowserLibraries.importLib('DBMS') ?>
  <?!= BrowserLibraries.importLib('ServerAccess') ?>
  <?!= app.include('EventsModel') ?>
  <?!= app.include('EventsController') ?>
  <?!= app.include('EventsView') ?>
  <?!= app.include('EventFormView') ?>
  <?!= app.include('EventCommentView') ?>
  <?!= app.include('ReadingsModel') ?>
  <?!= app.include('CommonModel') ?>
  <?!= app.include('globals') ?>


  <script>

    function startTest() {
      Db.init().then(() => {
        const event = {id:0, number:0, date:'2020-08-03', comment:'Testing'}
        EventsModel.addEvent(event).then(() => {
        console.table(Db.events)
        })
      })
    }

  // Refresh remote tables
  google.script.run
  .withSuccessHandler(startTest)
  .resumeTable(['events', 'water'])
    
  </script>

  </body>
</html>
