<script>

class ChargesModel {

  constructor() {
    this.server = new Server()
  }

  ackCharges(date) {
    // Local update
      const eventsToBeCharged = this.getEventsToBeCharged()
      eventsToBeCharged.forEach( (event) => {
        const tableIndex = app.getArrayIndex(app.events, event.id)
        app.events[tableIndex].cleared = date
      })
      // Server update
      this.server.apiCall('ackCharges', eventsToBeCharged, date)
  }

  getEventsToBeCharged() {
    return app.events.filter( (event) => {
      if (event.charging === 'x' && event.cleared === '') {
        return event
      }
    })
  }
}

</script>