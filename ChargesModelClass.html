<script>
//NÄMÄ OVAT EVENTS-TAPAHTUMIA. CHARGES-MODELIA EI ERIKSEEN TARVITA
class ChargesModel {

  static async ackCharges(date) {
    const events = this.getEventsToBeCharged()

    // Local update
    for (const event of events) {
      event.cleared = date
      Db.updateRecord('events', event)
    }

    // Server updates
    await Server.dbApi('GL_Events', 'updateRecords', events)
      Server.serviceApi('updateChargingSheet')
  }

  static getEventsToBeCharged() {
    const events = Db.getRecords('events').where('cleared', '').where('charging', 'x')
    return events.slice(0, events.length)  // Drop function defs from the array
  }
}

</script>