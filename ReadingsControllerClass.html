<script>

class ReadingsController {

  constructor() {
    this.model = new ReadingsModel()
    this.eventModel = new EventsModel() 
  }

  async addReading(reading) {
    app.spinner.on()
    await this.model.addReading(reading)
      this.openReadingsPage()
      app.spinner.off()
      app.popup.off()
  }

  openReadingsPage() {
    const readings = this.model.getReadings(10)
    const readingsView = new ReadingsView(this)
    readingsView.render(readings)
  }

  openReadingForm() {
    const years = this.eventModel.getYears()
    const currentYear = this.eventModel.getCurrentYear()
    const readingForm = new ReadingFormView(this)
    readingForm.render(years, currentYear)
  }

  openWaterPriceForm() {
    const waterPriceForm = new WaterPriceFormView()
    waterPriceForm.render(this.model.getCurrentWaterPrice())
  }
}

</script>