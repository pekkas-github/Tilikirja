<script>

/* GLOBALS */

  const app = {}
  const spinner = {
    on: () => {$('.spinner').show()},
    off: () => {$('.spinner').hide()}
  }
  const popup = {
    on: () => {$('.popup').show()},
    off: () => {$('.popup').hide()}
  }
  const util      = new Util()
  const infoView  = new InfoView()

/* KICK START */

  $('document').ready (() => {
    spinner.on()

    infoView.render()

    /* Event Listeners */
    $('#page0').on('click',infoView.render)

    $('#page1').on('click', () => {
      const controller = new EventsController()
      controller.openEventsPage()
    })
    $('#page2').on('click', () => {
      const controller = new ReadingsController()
      controller.openReadingsPage()
    })
    $('#page3').on('click',() => {
      const controller = new ReportsController()
      controller.openReportsPage() 
    })
    $('#page4').on('click',() => {
      const controller = new ChargesController()  
      controller.openChargesPage()
    })
    $('.nav-item').on('click', function() {
        $('.nav-item').css('background', '')
        $('.nav-item').css('font-weight', '')
        $(this).css('background', '#333385')
        $(this).css('font-weight', 'bold')
      })

    /* Data request */
    const server = new Server()

    server.apiCall('getAllData')
    .then(response => storeData(response))
    .catch(err => alert(err))
  })

  /* CALLBACK FUNCTIONS */
  function storeData(response) {
    app.events = response[0]
    app.water = response[1]
    app.years = response[2]
    app.accounts = response[3]
    app.currentYear = response[4]
    app.currentWaterPrice = response[5]

    spinner.off()
  }

</script>